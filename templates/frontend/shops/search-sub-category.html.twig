{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .search-estate{
            background: #413c46;
            min-height: 756px;
        }
        .advert .title{
            max-height: 50px;
            overflow: auto;
        }
    </style>
{% endblock %}
{% block body %}

    <div role="main" class="main">

        <section class="page-header page-header-modern bg-color-dark-scale-1 page-header-md" style="padding: 10px 0;">
            <div class="container">
                <div class="row">
                    <div class="col p-static">
                        <h1 data-title-border="">{{ categorySelected ? categorySelected.code|lower|trans : '' }}</h1>
                    </div>
                </div>
            </div>
        </section>

        <div class="container">

            <div class="row mb-4 properties-listing sort-destination p-0">
                <div class="row col-md-12">
                    <div class="city-search-dropdown search">
                        <ul class="cit-list">
                            <li class="city-item">tiznit</li>
                            <li class="city-item">agadir</li>
                            <li class="city-item">agadir</li>
                            <li class="city-item">agadir</li>
                            <li class="city-item">agadir</li>
                            <li class="city-item">fas</li>
                        </ul>
                    </div>
                    <div class="form-group col-md-4"></div>
                    <div class="form-group col-md-4">
                        <label class="required">{{ 'front.city.quartier'|trans }}</label>
                        <input type="text" class="form-control text-uppercase text-3" id="search-city"
                               placeholder="{{ 'front.city.quartier'|trans }}" autocomplete="off" value="{{ app.request.get('obj') ? app.request.get('obj') : (city ? city|trans : '') }}">
                    </div>
                    <div class="form-group col-md-4"></div>
                </div>
                <div class="col-md-3"></div>
                <div class="row col-md-9">
                    <div id="order-by" class="col-md-12 order-by">
                        <ul id="view-type-toolbar-buttons"
                            class="view-type-toolbar-buttons segmented-btn-group clearfix">
                            <li class="first-sort">
                                <a class="btn regular smaller get-sorted {% if app.request.get('sorted') == 'createDate-asc' %} selected {% endif %}" data-sort="createDate-asc"> {{ 'front.sort.date.asc'|trans }} </a>
                            </li>
                            <li class="first-sort">
                                <a class="btn regular smaller get-sorted {% if app.request.get('sorted') == 'createDate-desc' %} selected {% endif %}" data-sort="createDate-desc"> {{ 'front.sort.date.desc'|trans }} </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-3 search-portal">
                    {{ include('/frontend/static/block-search.html.twig') }}
                </div>
                <div class="col-md-9 row advert-portal">
                    {% for shop in shops %}
                        <div class="col-md-4 col-lg-4 col-sm-12 p-3 isotope-item home" style="padding: 6px !important;">
                            <div class="listing-item">
                                <a href="{{ path('single_shop', {id: shop.id, shop: shop.name }) }}" class="text-decoration-none">
                                    <div class="thumb-info thumb-info-lighten border advert">
                                        <div class="thumb-info-wrapper m-0">

                                            <img src="{{ asset('uploads/' ~ shop.images ~ '/0.png') }}"
                                                 class="img-fluid" alt="{{ shop.name }}" id="advert-img-{{ shop.id }}" style="height: 170px;">
                                            {#
                                            <div class="thumb-info-listing-type bg-color-secondary text-uppercase text-color-light font-weight-semibold p-1 pl-3 pr-3">
                                                {{ shop.name|trans }}
                                            </div>
                                            #}
                                            {% if app.user %}
                                                <div class="thumb-info-listing-type wishlist-icon" data-id="{{ shop.id }}">
                                                    {% if  shop.id in app.user.allWishes %}
                                                        <i class="fas fa-heart" aria-hidden="true"></i>
                                                    {% else %}
                                                        <i class="far fa-heart" aria-hidden="true"></i>
                                                    {% endif %}
                                                </div>
                                            {% endif %}
                                        </div>
                                        <div class="custom-thumb-info-title b-normal p-4">
                                            <div class="thumb-info-inner text-4 mb-1 title" id="advert-title-{{ shop.id }}">{{ shop.name|striptags }}</div>
                                            <div id="advert-agent-{{ shop.id }}" hidden style="display: none;">{{ shop.member ? shop.member.firstname ~ ' ' ~ shop.member.firstname : ' ' }}</div>
                                            <div id="advert-content-{{ shop.id }}" hidden style="display: none;">{{ 'front.form.contatc.content'|trans({'%reference%': '123222', '%site%': 'estate site'}) }}</div>
                                            <div class="thumb-info-inner text-3 mb-2"><i class="fa fa-map-marker-alt"></i>
                                                {% if shop.quartier %}
                                                    {{ shop.quartier.code|trans }}, {{ shop.quartier.city.code|trans }}
                                                {% elseif shop.city %}
                                                    {{ shop.city.code|trans }}, {{ shop.province.code|trans }}
                                                {% else %}
                                                    {{ shop.province.code|trans }}
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                {% if page_count >0 %}
                    <div class="col-md-12 my-5">
                        <ul class="pagination justify-content-center">
                            {% if 1 != current_page %}
                                <li class="page-item {{ (1==current_page)?'disabled':'' }}">
                                    <a class="page-link" href="{{ (1==current_page)?'#':path('front_category_shop',{'page':current_page-1, 'category': categorySelected ? categorySelected.code|lower : '' }) }}">
                                        <i class="fas {{ app.request.locale != 'ar' ? 'fa-angle-left' : 'fa-angle-right'}}"></i>
                                    </a>
                                </li>
                            {% endif %}
                            {%  for page in 1..page_count %}
                                <li class="page-item {{ (page==current_page)?'active':'' }}">
                                    <a class="page-link" href="{{ (page==current_page)?'#':path('front_category_shop',{'page':page, 'category': categorySelected ? categorySelected.code|lower : '' }) }}">{{ page }}</a>
                                </li>
                            {% endfor %}
                            {% if page_count != current_page %}
                                <li class="page-item {{ (page_count==current_page)?'disabled':'' }}">
                                    <a class="page-link" href="{{ (page_count==current_page)?'#':path('front_category_shop',{'page':current_page+1, 'category': categorySelected ? categorySelected.code|lower : '' }) }}">
                                        <i class="fas {{ app.request.locale == 'ar' ? 'fa-angle-left' : 'fa-angle-right'}}"></i>
                                    </a>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                {% endif %}
            </div>
        </div>

    </div>

{% endblock body %}

{% block javascripts %}
{{ parent() }}
    {{ include('/frontend/static/search.html.twig') }}

    <script type="text/javascript">
        $('#category, #sub-category, .get-sorted').on('change', function () {

            $('.search-home-shops form').submit();
        });

    </script>
{% endblock %}
